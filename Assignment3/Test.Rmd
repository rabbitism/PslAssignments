---
title: "Polynominal"
output: pdf_document
---

```{r}
rm(list=ls())
library(ISLR)

attach(Wage)

dim(Wage)
```
```{r}
names(Wage)
range(age)
```

```{r}
tmp = poly(age,3)
dim(tmp)
colMeans(tmp)

round(t(tmp) %*% tmp, dig=4)

```


```{r}
fit =lm(wage~poly(age, 3),  data= Wage)
round(summary(fit)$coef, dig=3)
```

```{r}
rm(list=ls())
library(splines)
library(ggplot2)

help(bs)
help(ns)

x = (1:199)/100
n = length(x)

m = 5

myknots = 2*(1:m)/(m+1)
myknots

X=cbind(1, x, x^2, x^3)

for(i in 1:m){
  tmp = (x-myknots[i])^3;
  tmp[tmp<0] = 0;
  X = cbind(X, tmp);
}

plot(c(0,2), range(X), type="n", xlab="", ylab="")

for(i in 1:(m+4)){
  tmp = X[,i];
  if(i<=4) mylty=1 else mylty=2;
  lines(x[tmp!=0], tmp[tmp!=0], col=i, lty=mylty, lwd=2)
}

for(i in 1:m){
  points(myknots[i], 0, pty="m", pch=19, cex=2)
}

F = bs(x, knots = myknots, intercept=TRUE)

dim(F)

```